"use strict";!function(r,o,e,l){e.isDefined,e.isObject,e.isNumber,e.isUndefined;function s(e){return"[object Object]"===Object.prototype.toString.call(e)}var c=e.isArray,i=(e.isFunction,e.isString),u=e.element,t=e.noop,a=(e.fromJson,e.copy,e.merge,e.isDate);function n(e){this.screen_size=null,this.elements=e}r.loadedMS=Date.now(),n.prototype.handler=function(){var e=this.screen_size,t=this.elements;"s"===e?(t.menu.hide(),t.main.show().attr("class","sixteen wide column"),t.mobile_bar.show()):"m"===e?(t.menu.show().attr("class","three wide column"),t.main.show().attr("class","thirteen wide column"),t.mobile_bar.hide()):"l"===e&&(t.menu.show().attr("class","two wide column"),t.main.show().attr("class","fourteen wide column"),t.mobile_bar.hide())},n.prototype.check=function(){var e=this.elements.window.width(),e=1920<=e?"l":1024<=e?"m":"s";return e!==this.screen_size&&(this.screen_size=e,!0)},n.prototype.watch=function(){var e=this;e.elements.window.resize(function(){e.check()&&e.handler()})},n.prototype.init=function(){this.check()&&this.handler(),this.watch()};var d=t;o(function(){var e={window:o(window),menu:o("#admin-menu"),main:o("#admin-main"),mobile_bar:o("#admin-mobile-bar"),main_form:o("#admin-main-form"),mobile_menu:o("#admin-mobile-menu")};e.main_form.unbind("submit"),new n(e).init(),e.mobile_menu.sidebar(),e.mobile_bar.find(".menu-opener").click(function(){e.mobile_menu.sidebar("toggle")}),d=function(){e.mobile_menu.sidebar("hide")}});var m=e.module("AdminApp",["ui.router"]).config(["$stateProvider","$urlRouterProvider","$compileProvider",function(i,e,t){function s(e){return r.urls.admin+"template/"+e+"?_="+r.loadedMS}e.otherwise("/general"),["general","social","header_menu","press_page","donation","footer","market_page","mining_page","converter_page","icos_page","currency_page","mining_script","exchanges_page","services_page","trends_page"].forEach(function(e){var t={},n=e+"_settings";t[n]=["API",function(e){return e.options.get(n)}],i.state(e,{url:"/"+e,templateUrl:s(e),controller:e,resolve:t})}),i.state("coins",{url:"/coins",templateUrl:s("coins"),controller:"coins"}),i.state("coin",{url:"/coin/{slug}",templateUrl:s("coin"),controller:"coin",resolve:{coin:["API","$stateParams",function(e,t){return e.coins.info(t.slug)}]}}),i.state("custom_pages",{url:"/custom_pages",templateUrl:s("custom_pages"),controller:"custom_pages",resolve:{pages:["API",function(e){return e.custom_pages.getAll()}]}}),i.state("custom_page",{url:"/custom_page/{id}",templateUrl:s("custom_page"),controller:"custom_page"}),i.state("users",{url:"/users",templateUrl:s("users"),controller:"users",resolve:{users:["API",function(e){return e.users.getAll()}]}}),i.state("user",{url:"/user/{id}",templateUrl:s("user"),controller:"user"}),i.state("custom_asset",{url:"/custom_asset/{id}",templateUrl:s("custom_asset"),controller:"custom_asset"}),t.debugInfoEnabled(!1)}]).run(["$rootScope","image_gallery","API","$interval","$transitions","page_loader",function(t,e,n,i,s,a){["urls","social_networks","twitter_cards","themes","timezones","languages","date_formats","time_formats","market_columns","web_miners"].forEach(function(e){t[e]=r[e]}),t.image_gallery=e,i(function(){n.session().then(function(e){e||window.location.reload()},function(){window.location.reload()})},3e5),s.onStart({},function(){a.start()}),s.onSuccess({},function(){d(),a.end(),o("html, body").animate({scrollTop:0},400)})}]);function p(e,r){var l=e+"_settings";m.controller(e,[l,"$scope","$element","API","page_loader","$state","$stateParams",function(e,t,n,i,s,a,o){t.errors={},t.settings=e,t.save=function(){s.start(),i.options.save(l,t.settings).then(function(e){t.settings=e,s.end()},function(e){t.errors=e,s.end()})},r&&r.apply(this,arguments)}])}m.service("API",["$http","$q",function(i,t){var n=this;n._url=r.urls.api,n.endpointURL=function(){var e=[].slice.call(arguments).join("/"),e=new URL(n._url+e);return e.searchParams.set("_",Date.now()),e.toString()},n.httpRequest=function(e){return t(function(t,n){i(e).then(function(e){t(e.data)},function(e){if(e=e.data,c(e)){var t={};return e.forEach(function(e){t[e]=!0}),n(t)}if(s(e))return n(e);n({})})})},n.session=function(){return n.httpRequest({method:"GET",url:n.endpointURL("session")})},n.options={get:function(e){return n.httpRequest({method:"GET",url:n.endpointURL("options",e)})},save:function(e,t){return n.httpRequest({method:"POST",url:n.endpointURL("options",e),data:t})}},n.pages=function(){return n.httpRequest({method:"GET",url:n.endpointURL("pages")})},n.custom_pages={getAll:function(){return n.httpRequest({method:"GET",url:n.endpointURL("pages","custom")})},get:function(e){return n.httpRequest({method:"GET",url:n.endpointURL("pages","custom",e)})},create:function(e){return n.httpRequest({method:"POST",url:n.endpointURL("pages","custom"),data:e})},update:function(e,t){return n.httpRequest({method:"POST",url:n.endpointURL("pages","custom",e),data:t})},remove:function(e){return n.httpRequest({method:"DELETE",url:n.endpointURL("pages","custom",e)})}},n.rates={all:function(){return n.httpRequest({method:"GET",url:n.endpointURL("rates")})},list:function(){return n.httpRequest({method:"GET",url:n.endpointURL("rates","list")})}},n.coins={list:function(){return n.httpRequest({method:"GET",url:n.endpointURL("coins","list")})},info:function(e){return n.httpRequest({method:"GET",url:n.endpointURL("coins","info",e)})},update:function(e,t){return n.httpRequest({method:"POST",data:t,url:n.endpointURL("coins","update",e)})},updateInfo:function(e){return n.httpRequest({method:"POST",url:n.endpointURL("coins","update_info",e)})},updateStatus:function(e,t){return n.httpRequest({method:"POST",url:n.endpointURL("coins","update_status",e,t)})}},n.images={list:function(){return n.httpRequest({method:"GET",url:n.endpointURL("images")})},remove:function(e){return n.httpRequest({method:"DELETE",url:n.endpointURL("images",e)})},upload:function(e){return n.httpRequest({method:"POST",headers:{"Content-Type":void 0},url:n.endpointURL("images"),data:e})}},n.users={getAll:function(){return n.httpRequest({method:"GET",url:n.endpointURL("users")})},get:function(e){return n.httpRequest({method:"GET",url:n.endpointURL("users",e)})},create:function(e){return n.httpRequest({method:"POST",url:n.endpointURL("users"),data:e})},update:function(e,t){return n.httpRequest({method:"POST",url:n.endpointURL("users",e),data:t})},remove:function(e){return n.httpRequest({method:"DELETE",url:n.endpointURL("users",e)})}},n.custom_assets={getAll:function(){return n.httpRequest({method:"GET",url:n.endpointURL("custom_assets")})},get:function(e){return n.httpRequest({method:"GET",url:n.endpointURL("custom_assets",e)})},create:function(e){return n.httpRequest({method:"POST",url:n.endpointURL("custom_assets"),data:e})},update:function(e,t){return n.httpRequest({method:"POST",url:n.endpointURL("custom_assets",e),data:t})},remove:function(e){return n.httpRequest({method:"DELETE",url:n.endpointURL("custom_assets",e)})}},n.services={list:function(){return n.httpRequest({method:"GET",url:n.endpointURL("services")})}}}]).service("page_loader",[function(){var t=u("#admin-main-loading"),n=[];this.start=function(e){c(e)?n=n.concat(e):i(e)&&n.push(e),t.addClass("loading")},this.end=function(e){!e||-1!==(e=n.indexOf(e))&&n.splice(e,1),n.length||t.removeClass("loading")}}]).service("image_gallery",["API","$parse",function(i,n){var s=this,a=u("#admin-image-gallery"),t=a.find("#admin-image-gallery-form"),e=t.find("input");s.images=[],s.target={context:null,path:null},s.open=function(t,n){i.images.list().then(function(e){s.images=e,a.modal("show"),s.target.context=t,s.target.path=n})},s.select=function(e){var t=s.images[e],e=s.target;e.context&&e.path&&n(e.path).assign(e.context,t.url),a.modal("hide")},s.upload=function(){e.off("change"),e.one("change",function(e){e=(e.target||window.event.srcElement).files;FileReader&&e&&e.length?(new FileReader,1048576<e[0].size?alert("Max Size (1MB) Exceeded"):i.images.upload(new FormData(t[0])).then(function(){i.images.list().then(function(e){s.images=e})})):console.log("File Reader Not Supported")}),e.click()},s.remove=function(t){var e;confirm("Are you sure your want to remove this image? This operation is irreversible.")&&(e=s.images[t],i.images.remove(e.name).then(function(e){e&&s.images.splice(t,1)}))}}]).service("languages",["API",function(e){var t=this;t.list=r.languages,t.current="en",e.options.get("general_settings").then(function(e){t.current=e.language})}]).factory("translationContent",[function(){return function(t,e){var n=null;return s(t)&&((n=(n=e?t[e]:n)||t.en)||Object.keys(t).some(function(e){e=t[e];if(e)return n=e,!0})),n}}]).component("adminImage",{bindings:{image:"=",title:"@"},template:['<div class="two fields"><div class="field">',"<label>{{ $ctrl.title }}</label>",'<img ng-click="$ctrl.open()" class="ui bordered small image" ng-src="{{ $ctrl.image || $ctrl.placeholder }}">',"<br>",'<div class="ui action input">','<input type="url" ng-model="$ctrl.image">','<div class="ui teal right labeled icon button" ng-click="$ctrl.open()">','<i class="image icon"></i>Select',"</div>","</div>","</div></div>"].join(""),controller:["image_gallery",function(e){var t=this;t.placeholder=r.image_placeholder,t.open=function(){e.open(t,"image")},t.$onInit=function(){}}]}).component("adminMenu",{bindings:{items:"="},template:["<div>",'<h4 class="ui header">New Item</h4>','<div class="fields">','<div class="four wide field" ng-class="{error: $ctrl.warning.type}">',"<label>Type</label>",'<select class="ui dropdown" ng-model="$ctrl.new_item.type" ng-options="type as details[0] for (type,details) in $ctrl.types"></select>',"</div>",'<div class="five wide field" ng-if="$ctrl.show(\'url\')" ng-class="{error: $ctrl.warning.url}">',"<label>URL</label>",'<input type="url" ng-model="$ctrl.new_item.data">',"</div>",'<div class="seven wide field" ng-if="$ctrl.show(\'text\')" ng-class="{error: $ctrl.warning.text}">',"<label>Text</label>",'<admin-multi-lang-input content="$ctrl.new_item.text">',"</div>",'<div class="four wide field" ng-if="$ctrl.show(\'page\')" ng-class="{error: $ctrl.warning.page}">',"<label>Page</label>",'<select class="ui dropdown" ng-model="$ctrl.new_item.data" ng-options="id as title for (id,title) in $ctrl.pages"></select>',"</div>",'<div class="four wide field" ng-if="$ctrl.show(\'custom_page\')" ng-class="{error: $ctrl.warning.custom_page}">',"<label>Custom Page</label>",'<select class="ui dropdown" ng-model="$ctrl.new_item.data" ng-options="id as title for (id,title) in $ctrl.custom_pages"></select>',"</div>",'<div class="four wide field" ng-if="$ctrl.show(\'social\')" ng-class="{error: $ctrl.warning.social}">',"<label>Social Network</label>",'<select class="ui dropdown" ng-model="$ctrl.new_item.data" ng-options="id as details[1] for (id,details) in $ctrl.social_networks"></select>',"</div>","</div>",'<div class="ui tiny blue labeled icon button" ng-click="$ctrl.add()"><i class="plus icon"></i>Add</div>','<h4 class="ui header">Items</h4>','<div class="ui selection large list" ng-if="$ctrl.items.length">','<div class="item" ng-repeat="item in $ctrl.items">','<div class="right floated content">','<div class="tiny ui basic icon buttons">','<div class="ui button" ng-if="!$first" ng-click="$ctrl.up($index)"><i class="up chevron icon"></i></div>','<div class="ui button" ng-if="!$last" ng-click="$ctrl.down($index)"><i class="down chevron icon"></i></div>','<div class="ui button" ng-click="$ctrl.edit($index)"><i class="pencil alternative icon"></i></div>','<div class="ui button" ng-click="$ctrl.remove($index)"><i class="trash icon"></i></div></div>',"</div>",'<i class="{{ $ctrl.types[item.type][1] }} icon"></i>','<div class="content">','<div class="header">{{ $ctrl.getTitle(item) }}</div> ','<div class="description">{{ $ctrl.getContent(item) }}</div> ',"</div>","</div>","</div>",'<div class="ui message" ng-if="!$ctrl.items.length"><div class="content">No Items Found</div></div>',"</div>"].join(""),controller:["$element","API","$scope","translationContent",function(e,t,n,s){var a=this;a.types={link:["Link","external link"],page:["Page","file"],custom_page:["Custom page","file outline"],donation:["Donation","hand peace"],social:["Social","thumbs up"]},a.new_item={},a.warning={},a.custom_pages={},a.pages={},a.social_networks=r.social_networks,a.default_lang="en",a.show=function(e){var t=a.new_item.type;return"text"===e||"url"===e?"link"===t:"page"===e?"page"===t:"custom_page"===e?"custom_page"===t:"social"===e&&"social"===t},a.add=function(){var e=a.new_item,t=e.type,n=e.data,i=s(e.text,a.default_lang);switch(a.warning={},t){case"link":if(!n||!i)return n||(a.warning.url=!0),void(i||(a.warning.text=!0));break;case"page":if(!a.pages[n])return void(a.pages[n]||(a.warning.page=!0));break;case"custom_page":if(!a.custom_pages[n])return a.custom_pages[n]||(a.warning.custom_page=!0),void(i||(a.warning.text=!0));break;case"donation":break;case"social":if(!a.social_networks[n])return void(a.warning.social=!0);break;default:return void(a.warning.type=!0)}a.items.push(a.new_item),a.new_item={}},a.getTitle=function(e){var t=e.type,n=e.data;return"social"!==t?"custom_page"===t?a.custom_pages[n]||"Not visible or nonexistent ?!":"page"===t?a.pages[n]||"Not visible or nonexistent ?!":"donation"===t?"Donation":s(e.text,a.default_lang):a.social_networks[e.data][1]||"(Not A Social Network)"},a.getContent=function(e){var t="",n=e.type,e=e.data;return t="link"===n?e:t},a.edit=function(e){a.new_item=a.items[e],a.items.splice(e,1)},a.remove=function(e){a.items.splice(e,1)},a.up=function(e){var t,n=a.items;0<e&&(t=n[e],n[e]=n[e-1],n[e-1]=t)},a.down=function(e){var t,n=a.items;e<n.length-1&&(t=n[e],n[e]=n[e+1],n[e+1]=t)},t.pages().then(function(e){e.built_in.forEach(function(e){a.pages[e.id]=e.title}),e.custom.forEach(function(e){a.custom_pages[e.id]=e.title})}),t.options.get("general_settings").then(function(e){a.default_lang=e.language}),a.$onInit=function(){c(a.items)||(a.items=[])},n.$watch("$ctrl.new_item.type",function(){a.warning={}})}]}).component("adminSearch",{bindings:{multiple:"@",values:"<",model:"="},template:['<div class="ui fluid search selection dropdown">','<div class="text"></div>','<i class="dropdown icon"></i>',"</div>"].join(""),controller:["$element","$timeout",function(n,t){var i=this;function s(e){e&&t(function(){i.multiple?i.model=e.split(","):e!==i.model&&(i.model=e)})}function a(){var e,t;c(i.values)&&(e=n.find(".ui.search.dropdown"),t={onChange:s,values:JSON.parse(JSON.stringify(i.values)),forceSelection:!1},"true"===i.multiple?(c(i.model)||(i.model=[]),t.values.forEach(function(e){-1!==i.model.indexOf(e.value)&&(e.selected=!0)}),e.addClass("multiple")):t.values.some(function(e){if(i.model===e.value)return e.selected=!0}),e.dropdown(t))}i.$onInit=a,i.$onChanges=function(e){e.values&&a()}}]}).component("adminCustomServices",{bindings:{services:"="},template:["<div>",'<div class="ui header">Custom Services</div><div class="field"><div class="ui tiny blue labeled icon button" ng-click="$ctrl.add()"><i class="plus icon"></i>New Service</div></div>','<div class="ui fluid styled accordion" ng-show="$ctrl.services.length">','<div class="title" ng-repeat-start="service in $ctrl.services"><i class="dropdown icon"></i>{{ service.name }}</div>','<div class="content" ng-repeat-end>','<div class="two fields">','<div class="six wide field"><label>Name</label><input type="text" placeholder="My Service" ng-model="service.name"></div>','<div class="ten wide field"><label>URL</label><input type="url" placeholder="https://some_url.domain" ng-model="service.url"></div>',"</div>",'<div class="field"><label>Description</label><textarea rows="3" placeholder="Describe the service" ng-model="service.description"></textarea></div>','<div class="field"><label>Tags (separated by commas)</label><input type="text" placeholder="payments, software" ng-model="service.tags"></div>','<div class="ui red button" ng-click="$ctrl.remove($index)">Remove</div>',"</div>","</div>",'<div class="ui message" ng-show="!$ctrl.services.length"><div class="content">No services were found.</div></div>',"</div>"].join(""),controller:["$element",function(e){var t=this;t.add=function(){t.services.push({name:"New Service",url:null,description:null,tags:null})},t.remove=function(e){confirm("Are you sure?")&&t.services.splice(e,1)},t.$onInit=function(){c(t.services)||(t.services=[]),e.find(".ui.accordion").accordion()}}]}).component("adminDateRange",{bindings:{start:"=",end:"="},template:['<div class="two fields">','<div class="field"><label>Start Date</label><div class="ui calendar start-date"><div class="ui input left icon"><i class="calendar icon"></i><input type="text" placeholder="Start"></div></div></div>','<div class="field"><label>End Date</label><div class="ui calendar end-date"><div class="ui input left icon"><i class="calendar icon"></i><input type="text" placeholder="End"></div></div></div>',"</div>"].join(""),controller:["$element","$timeout",function(n,i){var s=this;s.$onInit=function(){var e=n.find(".start-date"),t=n.find(".end-date");e.calendar({endCalendar:t,ampm:!1,onChange:function(e){i(function(){s.start=e})}}),t.calendar({startCalendar:e,ampm:!1,onChange:function(e){i(function(){s.end=e})}}),s.start&&(a(s.start)||(s.start=new Date(s.start)),e.calendar("set date",s.start,!0,!1)),s.end&&(a(s.end)||(s.end=new Date(s.end)),t.calendar("set date",s.end,!0,!1))}}]}).component("adminCustomIcos",{bindings:{icos:"="},template:["<div>",'<div class="field"><div class="ui tiny blue labeled icon button" ng-click="$ctrl.add()"><i class="plus icon"></i>New ICO</div></div>','<div class="ui fluid styled accordion">','<div class="title" ng-repeat-start="ico in $ctrl.icos"><i class="dropdown icon"></i>{{ ico.name }}</div>','<div class="content" ng-repeat-end>','<div class="two fields">','<div class="six wide field"><label>Name</label><input type="text" placeholder="My Service" ng-model="ico.name"></div>','<div class="ten wide field"><label>Website</label><input type="url" placeholder="https://some_url.domain" ng-model="ico.website"></div>',"</div>",'<div class="field"><label>Description</label><textarea rows="3" placeholder="Describe The ICO" ng-model="ico.description"></textarea></div>','<admin-date-range start="ico.start_date" end="ico.end_date"></admin-date-range>','<div class="field">','<div class="ui toggle checkbox">','<input type="checkbox" ng-model="ico.featured">',"<label>Featured</label>","</div>","</div>",'<admin-image image="ico.image" title="Image URL"></admin-image>','<div class="ui red button" ng-click="$ctrl.remove($index)">Remove</div>',"</div>","</div>","</div>"].join(""),controller:["$element","image_gallery",function(e,t){var n=this;n.image_gallery=t,n.add=function(){n.icos.push({name:"New ICO",website:null,image:null,description:null,start_date:null,end_date:null,featured:!1})},n.remove=function(e){confirm("Are you sure?")&&n.icos.splice(e,1)},n.$onInit=function(){c(n.icos)||(n.icos=[]),e.find(".ui.accordion").accordion()}}]}).component("adminMultiLangTextarea",{bindings:{content:"=",rows:"@"},template:['<div class="inline field">','<select class="ui dropdown" ng-model="$ctrl.languages.current" ng-options="lang.value as $ctrl.name(lang) for lang in $ctrl.languages.list"></select>',"</div>",'<div class="field">','<textarea rows="{{$ctrl.rows}}" ng-model="$ctrl.content[$ctrl.languages.current]"></textarea>',"</div>"].join(""),controller:["languages",function(e){var n=this;n.$onInit=function(){s(n.content)||(n.content={}),n.languages=e,n.name=function(e){if(n.content){var t=n.content[e.value];return t&&t.length?e.name+" ●":e.name}}}}]}).component("adminMultiLangInput",{bindings:{content:"="},template:['<div class="ui left action input">','<select class="ui dropdown" ng-model="$ctrl.languages.current" ng-options="lang.value as $ctrl.name(lang) for lang in $ctrl.languages.list"></select>','<input type="text" ng-model="$ctrl.content[$ctrl.languages.current]">',"</div>"].join(""),controller:["languages",function(e){var n=this;n.$onInit=function(){s(n.content)||(n.content={}),n.languages=e,n.name=function(e){if(n.content){var t=n.content[e.value];return t&&t.length?e.name+" ●":e.name}}}}]}).component("adminCustomSeo",{bindings:{settings:"="},template:['<div class="ui raised segment">','<div class="ui header">Custom SEO</div>','<div class="field"><div class="ui toggle checkbox"><input type="checkbox" ng-model="$ctrl.settings.seo_enabled"><label>Enabled</label></div></div>','<div ng-if="$ctrl.settings.seo_enabled">','<div class="field"><label>Title</label><input type="text" placeholder="SEO Title" ng-model="$ctrl.settings.seo_title"></div>','<div class="field"><label>Description</label><textarea rows="2" placeholder="SEO Description" ng-model="$ctrl.settings.seo_description"></textarea></div>','<admin-image image="$ctrl.settings.seo_og_image_url" title="OpenGraph Image URL"></admin-image>','<admin-image image="$ctrl.settings.seo_twitter_image_url" title="Twitter Image URL"></admin-image>',"</div>","</div>"].join("")}),p("general",function(e,t,n,i){t.pages=null,t.rates=null,i.pages().then(function(e){t.pages=e}),i.rates.list().then(function(e){t.rates=e})}),p("social"),p("header_menu"),p("press_page",function(t,n){n.new_feed={url:""},n.addFeed=function(){var e=n.new_feed.url;e&&(t.feeds.push(e),n.new_feed.url="")},n.removeFeed=function(e){t.feeds.splice(e,1)}}),p("donation",function(t,n){n.new_address={name:"",address:""},n.addAddress=function(){var e=n.new_address;e.name&&e.address&&(t.addresses.push(e),n.new_address={})},n.removeAddress=function(e){t.addresses.splice(e,1)}}),p("footer"),p("front_page"),p("market_page"),p("mining_page"),p("converter_page"),p("icos_page"),p("currency_page"),p("mining_script"),p("exchanges_page"),p("services_page",function(e,t,n,i){t.services_list=null,t.selected_service=null,s(e.overridden_urls)||(e.overridden_urls={}),i.services.list().then(function(e){t.services_list=e.map(function(e){return{value:e.slug,name:e.name}})})}),p("trends_page"),m.controller("custom_pages",["pages","$scope","API","$state","page_loader","translationContent",function(e,i,s,t,a,n){i.pages=e,i.getURL=function(e){e=i.pages[e],e=e.path||e.id;return r.urls.custom_pages+e+"?preview=1"},i.edit=function(e){e=i.pages[e];t.go("custom_page",{id:e.id})},i.remove=function(t){var e=i.pages[t];function n(){a.end()}confirm("Do you want to remove "+e.title+"?")&&(a.start(),s.custom_pages.remove(e.id).then(function(e){e&&i.pages.splice(t,1),n()},n))},i.getName=function(e){e=i.pages[e];return n(e.title)}}]).controller("custom_page",["$scope","$stateParams","$state","API","page_loader",function(t,e,n,i,s){t.errors={};e=e.id;e?"new"===e?t.page={}:(s.start(),i.custom_pages.get(e).then(function(e){t.page=e,s.end()},function(e){s.end()})):n.go("custom_pages"),t.save=function(){s.start();var e=t.page;t.errors={},e.id?i.custom_pages.update(e.id,e).then(function(e){t.page=e,s.end()},function(e){t.errors=e,s.end()}):i.custom_pages.create(e).then(function(e){s.end(),n.go("custom_page",{id:e.id})},function(e){t.errors=e,s.end()})},t.getURL=function(){var e=t.page,e=e.path||e.id;return r.urls.custom_pages+e+"?preview=1"},t.remove=function(){var e=t.page;confirm("Do you want to remove "+e.title+"?")&&i.custom_pages.remove(e.id).then(function(){n.go("custom_pages")})}}]).controller("users",["users","$scope","page_loader","$state","API",function(e,i,s,t,a){i.users=e,i.edit=function(e){e=i.users[e];t.go("user",{id:e.id})},i.remove=function(t){var e=i.users[t];function n(){s.end()}confirm("Do you want to remove "+e.email+"?")&&(s.start(),a.users.remove(e.id).then(function(e){e&&i.users.splice(t,1),n()},n))},i.create=function(){t.go("user",{id:"new"})}}]).controller("user",["$scope","$stateParams","$state","API","page_loader",function(n,e,i,s,a){e=e.id;function o(){var e=n.passwords;return!e[0]||e[0].length<8||20<e[0].length||e[0]!==e[1]?(e[0]="",e[1]="",void alert("Please correct your password")):(n.user.password=e[0],1)}n.passwords=["",""],n.updated=!1,e?"new"===e?n.user={active:1}:(a.start(),s.users.get(e).then(function(e){n.user=e,a.end()},function(){a.end()})):i.go("users"),n.save=function(){var t=n.user,e=n.passwords;t.id?(e[0]||e[1])&&!o()||(a.start(),s.users.update(t.id,t).then(function(e){a.end(),i.go("user",{id:t.id},{reload:!0})},function(){e[0]="",e[1]="",a.end()})):o()&&(a.start(),s.users.create(t).then(function(e){a.end(),e&&i.go("user",{id:e})},function(){e[0]="",e[1]="",a.end()}))},n.remove=function(){var e=n.user;confirm("Do you want to remove "+e.email+"?")&&s.users.remove(e.id).then(function(e){e&&i.go("users")})}}]).controller("custom_asset",["$scope","$stateParams","$state","API","page_loader",function(t,e,n,i,s){t.errors={},t.coins=null,t.page_url=null;e=e.id;function a(){i.coins.list().then(function(e){t.coins=e})}if(!e)return n.go("coins");"new"===e?(t.asset={},a()):(s.start(),i.custom_assets.get(e).then(function(e){t.asset=e,t.page_url=r.urls.currency_page+e.slug,a(),s.end()},function(){s.end()})),t.save=function(){s.start();var e=t.asset;t.errors={},e.id?i.custom_assets.update(e.id,e).then(function(e){t.asset=e,s.end()},function(e){t.errors=e,s.end()}):i.custom_assets.create(e).then(function(e){s.end(),n.go("custom_asset",{id:e.id})},function(e){t.errors=e,s.end()})},t.remove=function(){var e=t.asset;confirm("Do you want to remove "+e.name+"?")&&i.custom_assets.remove(e.id).then(function(){n.go("coins")})}}]).controller("coins",["$scope","API","$element","$compile",function(n,i,e,s){n.custom_assets=[];var a=e.find("table").DataTable({scrollX:!0,ajax:r.urls.api+"coins/table",columns:[{data:"name",render:function(e,t,n){return"<a ui-sref=\"coin({slug:'"+n.slug+"'})\">"+e+"</a>"}},{data:"symbol"},{data:"info_updated",render:function(e,t,n){return(e?l.unix(e).format("YYYY/MM/DD HH:mm"):"Never")+("&nbsp;<div ng-click=\"updateInfo('"+n.slug+'\')" class="ui right floated mini icon teal button"><i class="sync icon"></i></div>')}},{data:"prices_updated",render:function(e){return e?l.unix(e).format("YYYY/MM/DD HH:mm"):"Never"}},{data:"status",render:function(e,t,n){var i,s,e=1===e?(i="green",s="enabled",0):(i="red",s="disabled",1);return"<div ng-click=\"updateStatus('"+n.slug+"',"+e+')" style="cursor: pointer" class="ui center aligned fluid '+i+' label">'+s+"</div>"}}],rowCallback:function(e,t){s(e)(n)}});n.updateAll=function(){a.ajax.reload(null,!1)},n.updateInfo=function(e){i.coins.updateInfo(e).then(function(){a.ajax.reload(null,!1)})},n.updateStatus=function(e,t){i.coins.updateStatus(e,t).then(function(){a.ajax.reload(null,!1)})},i.custom_assets.getAll().then(function(e){n.custom_assets=e})}]).controller("coin",["coin","$scope","page_loader","API","$element",function(t,n,i,e,s){var a=t.slug;function o(e){return e.info_updated=l.unix(e.info_updated).format("YYYY/MM/DD HH:mm"),e.prices_updated=l.unix(e.prices_updated).format("YYYY/MM/DD HH:mm"),e}n.page_url=r.urls.currency_page+a,n.coin=o(t),n.updateInfo=function(){e.coins.updateInfo(a).then(function(e){t.info_updated=l.unix(e).format("YYYY/MM/DD HH:mm")})},n.save=function(){i.start(),e.coins.update(a,{status:n.coin.status,page_content:n.coin.page_content}).then(function(e){n.coin=o(e),i.end()},function(){i.end()})}}])}(window.CoinTableAdminConstants,jQuery,angular,moment);