"use strict";!function(o,r,s,c){var a=o.coin,e={animation:!1,dataset:{source:null},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},toolbox:{feature:{restore:{title:" "},saveAsImage:{title:" "}}},grid:[{left:"3%",right:"4%",bottom:200},{left:"3%",right:"4%",height:80,bottom:80}],dataZoom:[{type:"inside",xAxisIndex:[0,1]},{show:!0,xAxisIndex:[0,1],type:"slider",bottom:10,handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleStyle:{color:"#fff",borderColor:"#ACB8D1"}}],legend:{padding:[40,5,20,5],data:[o.chart.price.label,o.chart.market_cap.label,o.chart.volume.label]},xAxis:[{type:"category",scale:!0,boundaryGap:!1,splitLine:{show:!1}},{type:"category",gridIndex:1,scale:!0,boundaryGap:!1,axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1}}],yAxis:[{position:"right",type:"value",axisTick:{show:!1},axisLine:{show:!1},axisLabel:{inside:!0},splitLine:{show:!0,lineStyle:{opacity:.5}},min:"dataMin"},{type:"value",axisTick:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisLabel:{inside:!0,formatter:function(t){return l.chartYAxisFormatter.format(t)+"\n\n"}},min:"dataMin"},{scale:!0,gridIndex:1,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],series:[{type:"line",name:o.chart.price.label,symbol:"none",itemStyle:{color:o.chart.price.color},encode:{x:0,y:1}},{type:"line",name:o.chart.market_cap.label,symbol:"none",yAxisIndex:1,itemStyle:{color:o.chart.market_cap.color},encode:{x:0,y:2}},{type:"bar",name:o.chart.volume.label,xAxisIndex:1,yAxisIndex:2,itemStyle:{color:o.chart.volume.color},encode:{x:0,y:3}}]},l=(a.tracking&&(e.legend.data.splice(1,2),e.xAxis.splice(1,1),e.yAxis.splice(1,2),e.series.splice(1,2),e.dataZoom[0].xAxisIndex=[0],e.dataZoom[1].xAxisIndex=[0],e.grid.splice(1,1),e.grid[0].bottom=80),{elements:{document:null,price:null,chart_wrapper:null,chart:null,chart_menu:null,converter:null,tickers:null,tickers_btn:null},converter_options:{slug:null,multiple:1},chart:null,chartYAxisFormatter:new Intl.NumberFormat(o.lang,{notation:"compact",compactDisplay:"short",minimumSignificantDigits:3}),chart_datasets:{},tickers_control:{page:1,items:o.tickers.size,enabled:!0,lock:!1},init:function(){var t=this.elements;a.tracking?(this.converter_options.slug=a.tracking[0],this.converter_options.multiple=parseFloat(a.tracking[1])):this.converter_options.slug=o.coin.slug,this.initChart(),t.document.on("fxready",function(){l.initConverter()}),t.tickers.length&&this.initTickers()},dateFormat:function(t){return c.format.formatTime("yyyy-MM-dd\nhh:mm",new Date(t))},initChart:function(){var t=this.elements;t.chart.length&&(this.chart=c.init(t.chart[0],{width:"auto",height:"auto"}),t=this.elements.chart_menu.find(".item.active").data("dataset"),this.downloadChartData(t,function(t){e.dataset.source=t,l.chart.setOption(e)}),this.initChartEvents())},updateChart:function(t){this.chart_datasets[t]&&(this.chart.setOption({dataset:{source:l.chart_datasets[t]}}),this.chart.dispatchAction({type:"dataZoom",start:0,end:100}))},downloadChartData:function(t,e){if(this.chart_datasets[t])return e&&e(this.chart_datasets[t]);var a=this.converter_options.slug,i=o.chart.currency,s=l.converter_options.multiple,a="https://api.coingecko.com/api/v3/coins/"+a+"/market_chart?vs_currency="+i+"&days="+t,n=this.elements;n.chart_wrapper.addClass("loading"),r.getJSON(a,function(i){const n=[],r=Intl.NumberFormat("en",{minimumSignificantDigits:4,maximumSignificantDigits:6,maximumFractionDigits:8});i.prices.forEach((t,e)=>{var a=new Date(t[0]);n.push([c.format.formatTime("yyyy-MM-dd hh:mm",a),r.format(t[1]*s).replace(",",""),Math.round(i.market_caps[e][1]),Math.round(i.total_volumes[e][1])])}),l.chart_datasets[t]=n,e&&e(n)}).always(function(){n.chart_wrapper.removeClass("loading")})},initChartEvents:function(){var a=this.elements.chart_menu.find(".item");a.click(function(){a.removeClass("active");var t=r(this),e=t.data("dataset");l.downloadChartData(e,function(){l.updateChart(e)}),t.addClass("active")}),r(window).on("resize",function(){l.chart&&l.chart.resize({width:"auto",height:"auto"})})},initConverter:function(){var e,a,t=this.elements.converter,i=o.price_currency,n=this.converter_options.slug,r=this.converter_options.multiple;t.length&&(e=t.find(".input-left"),(a=t.find(".input-right")).val(s._priceFormat(s(parseFloat(e.val())).from(n).to(i)*r)),e.on("change paste keyup",function(){var t=parseFloat(e.val());a.val(s._priceFormat(s(t).from(n).to(i)*r))}),a.on("change paste keyup",function(){var t=parseFloat(a.val());e.val(s._priceFormat(s(t).from(i).to(n)*r))}))},initTickers:function(){this.elements.tickers_btn.click(function(){l.addTickers()}),l.addTickers()},addTickers:function(){var e,t,i=this.tickers_control;i.enabled&&!i.lock&&(i.lock=!0,(e=this.elements).tickers.addClass("loading"),t=o.urls.api+"/tickers/"+a.slug+"/"+i.page+"/"+i.items,r.getJSON(t,function(t){var a;t&&t.length&&(a="",r.each(t,function(t,e){a=(a+="<tr>")+"<td>"+e.rank+"</td><td>",e.exchange_image&&(a+='<img class="ui right spaced avatar image" src="'+e.exchange_image+'">'),e.exchange_url?a+='<a href="'+e.exchange_url+'" target="_blank">'+e.exchange_name+"</a>":a+="<span>"+e.exchange_name+"</span>",a=(a=(a=(a+="</td>")+'<td><a href="'+e.url+'" target="_blank">'+e.base+"/"+e.quote+"</a></td>")+'<td class="right aligned">'+e.last_price+"</td>")+'<td class="right aligned">'+e.volume+"</td></tr>"}),e.tickers.find("table > tbody").append(a),i.page++),(!t||t.length<i.items)&&(i.enabled=!1,e.tickers_btn.hide())}).always(function(){e.tickers.removeClass("loading"),i.lock=!1}))}});r(function(){var t=l.elements;t.document=r(document),t.price=r("#currency-price"),t.chart_wrapper=r("#currency-chart-wrapper"),t.chart=r("#currency-chart"),t.chart_menu=r("#currency-chart-menu"),t.converter=r("#currency-converter"),t.tickers=r("#currency-tickers"),t.tickers_btn=r("#currency-tickers-load-btn"),l.init()})}(window.CoinTableConstants,jQuery,fx,echarts);